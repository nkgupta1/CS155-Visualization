\newif\ifshowsolutions
\showsolutionstrue
\input{preamble}
\newcommand{\boldline}[1]{\underline{\textbf{#1}}}

\chead{%
  {\vbox{%
      \vspace{2mm}
      \large
      Machine Learning \& Data Mining \hfill
      Caltech CS/CNS/EE 155 \hfill \\[1pt]
      Miniproject 3\hfill
      Released March $3^{rd}$, 2017 \\
    }
  }
}

\usepackage{amsfonts} %Mathbb Fonts
\usepackage{amsmath} %Text in Math
\usepackage{longtable} %Make multi-page tables
\usepackage{enumitem}
\usepackage{graphicx} % Import pics \includegraphics[scale=0.7]{SGD}
\graphicspath{{../graphics/}} % Change pic path
\usepackage{makecell}
\usepackage[margin=2.25cm]{caption}
\usepackage[toc,page]{appendix}

\begin{document}
\pagestyle{fancy}

\section{Introduction}
\medskip
\begin{itemize}

    \item \boldline{Group members} \\
    Vaibhav Anand \\
    Nikhil Gupta \\
    Michael Hashe
    
    \item \boldline{Team name} \\
    The Breakfast Club

    \item \boldline{GitHub link} \\
    \href{https://github.com/nkgupta1/CS155-Visualization}{https://github.com/nkgupta1/CS155-Visualization}
    
    \item \boldline{Division of labour} \\
    Vaibhav Anand: Matrix Factorization Visualizations, Report\\
    Nikhil Gupta: Matrix Factorization Algorithm, Report \\
    Michael Hashe: Basic Visualizations, Report

\end{itemize}

\section{Basic Visualizations}
\medskip
\subsection{Justify your choice of visualization method}
\subsection{What did you observe?}
\subsection{Did the results match what you would expect to see?}
\subsection{How do the ratings of the best movies compare to those of those of the most popular movies}
\subsection{How do the ratings of the three genres you chose compare to one another}
\subsection{Any other comparisons/observations}

\section{Matrix Factorization Algorithm}
\medskip
\subsection{What parameters did you adjust and how?}
\noindent We adjusted:
\begin{itemize}
  \item the learning rate $\eta$
  \item the regularization strength $\lambda$
  \item the stopping parameter $\epsilon$
\end{itemize}
For the ways we adjusted $\eta,\lambda$, please see Appendix \ref{appendix:gridsearch}. How we adjusted $\epsilon$ is described in the next subsection.

\subsection{Justify your choices for the parameters and stopping criteria}
We grid searched for values of the $\eta,\lambda$ that would provide the best test error. We broke up the data into a training set including $\frac{2}{3}$ of the data and a test set containing the remaining $\frac{1}{3}$ of the data. Please see Appendix \ref{appendix:gridsearch} for results. In addition, we tried various stopping criteria and ended up settling on $\epsilon=0.003$ as the one that gave the best test error. In order to determine this, we tried different orders of magnitude (0.0001, 0.001, 0.01, 0.1) for the value and after finding the best one (0.001), increased the resolution of the search (0.001, 0.002, 0.003, 0.004, 0.005) ending up settling on a specific value (0.003). 

\subsection{Did you make any other significant modifications or additions}
We tried various methods of training:
\begin{itemize}
  \item excluding regularization error in calculating stopping criterion
  \item including regularization error in calculating stopping criterion
  \item removing the mean from the ratings
  \item adding a bias term for individuals and movies and training on that
\end{itemize}
Each of these changes progressively made the out of sample error better.

\section{Matrix Factorization Visualization}
\medskip
\subsection{What did you observe?}
We observed a significant correlation in the rating of a movie and one of the 2 dimensions of $\widetilde{V}$ [Figure ]. Although there was no discernible correlation between movie genre and either of the dimensions, we noticed that movies belonging from the same series (like sequels of Star Trek movies) appeared to be clustered closer to together compared to random noise [Figure ]. We also attempted to find correlations between popularity and dating of the movies and the two dimensions. The release date of a movie appeared to have none [Figure]. 

\subsection{How do the ratings of the best movies compare to those of the most popular movies}
Popularity appeared to have a slight correlation in the same dimension and direction as rating in $\widetilde{V}$ [Figure ]. We believe this is because popularity is inherently correlated with the rating of a movie, meaning that more popular movies tend to have higher ratings, and since the correlation is stronger with $\widetilde{V}$ and rating, we believe the popularity correlation is a side effect of that.

\subsection{How do the ratings of the three genres you chose compare to one another}
As shown in Figure [], there is no difference in the values of the two dimensions $\widetilde{V}$ and the three genres. Overall, the distribution of ratings for the three genres is similar and is explained in more depth and shown in section (2).

\subsection{What was expected and what was surprising from the visualizations?}
We expected to see a stronger (or any) correlation between the 2 dimensions of $\widetilde{V}$ and the genres, as shown in the examples in class. Even after implementing bias and bias regularization in the matrix factorization and grid-searching to find the optimal step size and regularizations, the $E_{out}$ did not decrease below 0.446 and the visualization of $\widetilde{V}$ after performing SVD did not result in any meaningful correlations besides the average rating of movies, which is rather obvious with ML.

\subsection{Any other comparisons/observations}
While there may be correlations between features in the movies given by $\widetilde{V}$, they go beyond genres and dating. More detailed observations on individual genres can be seen in Figures [A-B].\\

Also, before we implemented bias and bias regularization in the matrix factorization, the values of $V$ for the movies were in the positive quadrant, the correlation between popularity and rating appeared to be stronger, and $E_{out}$ was higher. However, after bias, the data became more centered in both dimensions.


\section{Conclusion}
\medskip
\subsection{Briefly summarize your main observations}
\subsection{Did your visualizations help you to better understand the MovieLens dataset?}


\begin{appendices}

\section{Grid Search Results}
\label{appendix:gridsearch}
\subsection{error without regularization in training (ordered by out of sample error)}

\noindent first $\frac{2}{3}$ training, last $\frac{1}{3}$ test: \\
\texttt{
  errOut = 0.643741, reg = 0.10000, eta = 0.0100, errIn = 0.267795 \\
  errOut = 0.651725, reg = 0.10000, eta = 0.0200, errIn = 0.252123 \\
  errOut = 0.661422, reg = 0.10000, eta = 0.0050, errIn = 0.286361 \\
  errOut = 0.666840, reg = 0.10000, eta = 0.0090, errIn = 0.269846 \\
  errOut = 0.670787, reg = 0.10000, eta = 0.0100, errIn = 0.250795 \\
  errOut = 0.676144, reg = 0.08000, eta = 0.0100, errIn = 0.220056 \\
  errOut = 0.676604, reg = 0.11000, eta = 0.0100, errIn = 0.283961 \\
  errOut = 0.677733, reg = 0.18000, eta = 0.0100, errIn = 0.387222 \\
  errOut = 0.678625, reg = 0.12000, eta = 0.0100, errIn = 0.301132 \\
  errOut = 0.679735, reg = 0.10000, eta = 0.0100, errIn = 0.281514 \\
  errOut = 0.682994, reg = 0.10000, eta = 0.0100, errIn = 0.262050 \\
  errOut = 0.683584, reg = 0.10000, eta = 0.0500, errIn = 0.284322 \\
  errOut = 0.683747, reg = 0.10000, eta = 0.0100, errIn = 0.259213 \\
  errOut = 0.686960, reg = 0.09000, eta = 0.0100, errIn = 0.261056 \\
  errOut = 0.692979, reg = 0.10000, eta = 0.0100, errIn = 0.258826 \\
  errOut = 0.714738, reg = 0.10000, eta = 0.0500, errIn = 0.284227 \\
  errOut = 0.731857, reg = 0.15000, eta = 0.0100, errIn = 0.362397 \\
  errOut = 0.751690, reg = 0.10000, eta = 0.1000, errIn = 0.388069 \\
  errOut = 0.752882, reg = 0.30000, eta = 0.0100, errIn = 0.468818 \\
  errOut = 0.753859, reg = 0.20000, eta = 0.0100, errIn = 0.420194 \\
  errOut = 0.761073, reg = 0.10000, eta = 0.1000, errIn = 0.394411 \\
  errOut = 0.821591, reg = 0.40000, eta = 0.0100, errIn = 0.516962 \\
  errOut = 0.852405, reg = 0.01000, eta = 0.0100, errIn = 0.152351 \\
  errOut = 0.854635, reg = 0.50000, eta = 0.0100, errIn = 0.560920 \\
  errOut = 0.918906, reg = 0.60000, eta = 0.0100, errIn = 0.620285 \\
  errOut = 0.925896, reg = 0.00010, eta = 0.0100, errIn = 0.142089 \\
  errOut = 0.931411, reg = 0.70000, eta = 0.0100, errIn = 0.681322 \\
  errOut = 0.935970, reg = 0.00100, eta = 0.0100, errIn = 0.148187 \\
  errOut = 0.943312, reg = 0.00000, eta = 0.0100, errIn = 0.142968 \\
  errOut = 1.066705, reg = 0.80000, eta = 0.0100, errIn = 0.769256 \\
  errOut = 1.250584, reg = 1.00000, eta = 0.0100, errIn = 0.956924 \\
}

\noindent first $\frac{1}{3}$ training, last $\frac{2}{3}$ test: \\
\texttt{
  errOut = 0.460330, reg = 0.10000, eta = 0.0100, errIn = 0.260879 \\
  errOut = 0.461616, reg = 0.10000, eta = 0.0050, errIn = 0.274322 \\
  errOut = 0.462888, reg = 0.10000, eta = 0.0090, errIn = 0.267259 \\
  errOut = 0.467803, reg = 0.10000, eta = 0.0200, errIn = 0.270230 \\
  errOut = 0.651215, reg = 0.01000, eta = 0.0090, errIn = 0.140637 \\
  errOut = 0.659732, reg = 0.01000, eta = 0.0100, errIn = 0.145086 \\
  errOut = 0.681749, reg = 0.01000, eta = 0.0050, errIn = 0.129947 \\
  errOut = 0.687374, reg = 0.01000, eta = 0.0200, errIn = 0.151102
}

\subsection{error with reg in training and mean removed}

\noindent first $\frac{2}{3}$ training, last $\frac{1}{3}$ test: \\
\texttt{
  errOut = 0.472064, reg = 0.10000, eta = 0.0050, errIn = 0.222142 \\
  errOut = 0.474038, reg = 0.10000, eta = 0.0100, errIn = 0.224702 \\
  errOut = 0.477569, reg = 0.10000, eta = 0.0010, errIn = 0.290618 \\
  errOut = 0.491969, reg = 0.10000, eta = 0.1000, errIn = 0.237443 \\
  errOut = 0.624262, reg = 1.00000, eta = 0.0050, errIn = 0.638081 \\
  errOut = 0.624280, reg = 1.00000, eta = 0.1000, errIn = 0.638152 \\
  errOut = 0.624281, reg = 1.00000, eta = 0.0100, errIn = 0.638098 \\
  errOut = 0.732767, reg = 0.01000, eta = 0.0050, errIn = 0.114247 \\
  errOut = 0.789952, reg = 0.01000, eta = 0.0100, errIn = 0.103601 \\
  errOut = 0.819212, reg = 0.01000, eta = 0.1000, errIn = 0.202040 \\
  errOut = 0.847534, reg = 0.00100, eta = 0.0050, errIn = 0.110945 \\
  errOut = 0.868467, reg = 0.00010, eta = 0.1000, errIn = 0.440801 \\
  errOut = 0.880642, reg = 0.00010, eta = 0.0050, errIn = 0.109889 \\
  errOut = 0.921586, reg = 0.00100, eta = 0.1000, errIn = 0.417915 \\
  errOut = 1.048777, reg = 0.00100, eta = 0.0100, errIn = 0.100087 \\
  errOut = 1.088209, reg = 0.00010, eta = 0.0100, errIn = 0.100609
}

\subsection{error with reg in training, mean removed, bias term, stopping parameter = 0.003:}

\noindent first $\frac{2}{3}$ training, last $\frac{1}{3}$ test: \\
\texttt{
  errOut = 0.446253, reg = 0.10000, eta = 0.0100, errIn = 0.242214 \\
  errOut = 0.448719, reg = 0.10000, eta = 0.0050, errIn = 0.255420 \\
  errOut = 0.478732, reg = 0.10000, eta = 0.1000, errIn = 0.230768 \\
  errOut = 0.492864, reg = 1.00000, eta = 0.0100, errIn = 0.476065 \\
  errOut = 0.494233, reg = 1.00000, eta = 0.0050, errIn = 0.475877 \\
  errOut = 0.507058, reg = 1.00000, eta = 0.1000, errIn = 0.493825 \\
  errOut = 0.594936, reg = 0.01000, eta = 0.0050, errIn = 0.150427 \\
  errOut = 0.621251, reg = 0.01000, eta = 0.0100, errIn = 0.136140 \\
  errOut = 0.798689, reg = 0.01000, eta = 0.1000, errIn = 0.207856
  }


\section{Matrix Factorization Visualizations}
\label{appendix:matrixvisual}

%\includegraphics[scale=0.35]{"All Movies"}
%\includegraphics[scale=0.35]{"Popularity Comparison"} \\ \\
%\includegraphics[scale=0.35]{"Rating Comparison"}
%\includegraphics[scale=0.35]{"3-Genre Comparison"} \\ \\
%\includegraphics[scale=0.35]{"All Genre Comparison"}
%\includegraphics[scale=0.35]{"Series: Star Trek"} \\ \\
%\includegraphics[scale=0.35]{"Year: 1998"} \\ \\

\noindent
%\includegraphics[scale=0.26]{"genres/Genre: Action"}
%\includegraphics[scale=0.26]{"genres/Genre: Adventure"}
%\includegraphics[scale=0.26]{"genres/Genre: Animation"} \\ \\
%\includegraphics[scale=0.26]{"genres/Genre: Childrens"}  
%\includegraphics[scale=0.26]{"genres/Genre: Comedy"}
%\includegraphics[scale=0.26]{"genres/Genre: Crime"} \\ \\
%\includegraphics[scale=0.26]{"genres/Genre: Documentary"}
%\includegraphics[scale=0.26]{"genres/Genre: Drama"}  
%\includegraphics[scale=0.26]{"genres/Genre: Fantasy"} \\ \\
%\includegraphics[scale=0.26]{"genres/Genre: Film-Noir"}
%\includegraphics[scale=0.26]{"genres/Genre: Horror"}
%\includegraphics[scale=0.26]{"genres/Genre: Musical"} \\ \\
%\includegraphics[scale=0.26]{"genres/Genre: Mystery"}
%\includegraphics[scale=0.26]{"genres/Genre: Romance"}
%\includegraphics[scale=0.26]{"genres/Genre: Sci-Fi"} \\ \\
%\includegraphics[scale=0.26]{"genres/Genre: Thriller"}  
%\includegraphics[scale=0.26]{"genres/Genre: War"}
%\includegraphics[scale=0.26]{"genres/Genre: Western"}

\end{appendices}

\end{document}